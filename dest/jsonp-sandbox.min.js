!function(e){"use strict";function n(){}function o(){this.sandbox=this._createSandbox()}var t="#"+Math.random(),s=0;o._callbacks={},o._onmessage=function(n){n=n||e.event;var t=n.data;if(e.JSON&&"string"==typeof t)try{t=JSON.parse(t)}catch(s){t={}}var a=t.id,r=o._callbacks;r.hasOwnProperty(a)&&(r=r[a],t.error?r[1](t.error):r[0](t.response),delete r[a])},o.prototype={constructor:o,get:function(a){"string"==typeof a&&(a={url:a,success:arguments[1],error:arguments[2]});var r=a.url,d=a.key||"callback",c=a.value||"jsonp"+s,i=a.success||n,u=a.error||n,l=a.data||{},p=e.encodeURIComponent,f=[];for(var g in l)f.push(p(g)+"="+p(l[g]));f=f.join("&"),r=/\?/.test(r)?r+f:r+"?"+f,s++;var m=s+t;o._callbacks[m]=[i,u],this._postMessage({id:m,url:r,value:c,key:d})},destroy:function(){this.sandbox.src="about:blank",this.sandbox.srcdoc="",this.sandbox.parentNode.removeChild(this.sandbox),this.sandbox=null},_createSandbox:function(){var e=document.createElement("iframe"),n=document.body||document.documentElement;e.style.display="none",n.appendChild(e);var o=this._getSandboxCode(),t=e.contentWindow.document;return e.sandbox="allow-scripts","srcdoc"in e?e.srcdoc=o:(t=e.contentWindow.document,t.open(),t.write(o),t.close()),e},_postMessage:function(n){var o=this,t=this.sandbox;!this._sandboxReady&&"srcdoc"in t?(t.onload||(this._queue=[],t.onload=function(){o._sandboxReady=!0;for(var e=0;e<o._queue.length;e++)o._postMessage(o._queue[e]);delete t.onload,delete o._queue}),this._queue.push(n)):(e.JSON&&(n=JSON.stringify(n)),t.contentWindow.postMessage(n,"*"))},_getSandboxCode:function(){return"<html><head></head><body><script>("+function(e,n,o,t,s,a,r,d){function c(e){e.error&&(e.error=e.error.toString()),t&&(e=t.stringify(e)),n.postMessage(e,"*")}function i(e,n){var o=arguments[2]||"",t=+new Date,s=e.replace(/([?&])_=[^&]*/,"$1_="+t);e=s+(s===e?(/\?/.test(e)?"&":"?")+"_="+t:""),e+=o;var c=d.call(a,"script");c.onload=c.onreadystatechange=function(){var e=!c.readyState||/loaded|complete/.test(c.readyState);e&&(c.onload=c.onreadystatechange=null,r.removeChild(c),n&&n(null))},c.onerror=function(){n(new Error("Failed to load: "+c.src))},c.src=e,r.appendChild(c)}if(o){var u=[],l=e,p={console:!0,onmessage:!0,postMessage:!0,event:!0};for(var f in l)p[f]||u.push("function "+f+"(){}");u=u.join(""),o(u)}s&&Object.keys(s.prototype).forEach(function(e){"close"!==e&&delete s.prototype[e]}),e.onmessage=function(n){function o(e){e||"undefined"!=typeof s.response||(e=new Error("Wrong format.")),e&&(s.error=e),c(s)}n=n||e.event;var s=n.data;t&&(s=t.parse(s));var a=s.value,r=s.url,d=s.key;e[a]=function(n){s.response=n,e[a]=null},i(r,o,"&"+encodeURIComponent(d)+"="+encodeURIComponent(a))},e.postMessage||(e.postMessage=function(n){e.onmessage({data:n})}),e.onerror=function(e){console.warn("JSONP.Sandbox:",e)}}.toString()+")("+["window","parent","window.execScript","window.JSON","window.Document","document","document.body","document.createElement"].join(",")+")</script></body></html>"}},e.postMessage?e.addEventListener?e.addEventListener("message",o._onmessage,!1):e.attachEvent("onmessage",o._onmessage):e.postMessage||(e.postMessage=function(e){o._onmessage({data:e})});var a={get:function(){a._sandbox||(a._sandbox=new o),a._sandbox.get.apply(a._sandbox,arguments)},Sandbox:o};"function"==typeof define?define(function(){return a}):"object"==typeof module?module.exports=a:e.JSONP=a}(window);